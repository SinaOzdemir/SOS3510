<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Frequency based analysis of text: | 07-text_cleaning.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Frequency based analysis of text: | 07-text_cleaning.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Frequency based analysis of text: | 07-text_cleaning.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path=""><a href="#frequency-based-analysis-of-text"><i class="fa fa-check"></i><b>1</b> Frequency based analysis of text:</a>
<ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#cleaning-text-data"><i class="fa fa-check"></i><b>1.1</b> Cleaning text data:</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path=""><a href="#removing-the-noise"><i class="fa fa-check"></i><b>1.1.1</b> Removing the noise</a></li>
<li class="chapter" data-level="1.1.2" data-path=""><a href="#stemming-and-lemmatization"><i class="fa fa-check"></i><b>1.1.2</b> Stemming and lemmatization:</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="frequency-based-analysis-of-text" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Frequency based analysis of text:<a href="#frequency-based-analysis-of-text" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>While this might be stating the obvious, content analysis is primarily about quantitatively describing the content of texts. Of course, this does not mean that inferences cannot be made based on the description but the main goal is to create a numeric description of the text. One of the most basic method of this is simply to count the occurance of something in the text. Then, for example, we can look at the differences in frequencies in a comparative study to make an inference. So we will take a look at how to describe a text with some assitance from computer. There are many methods to quantitatively summarise and compare texts; collocation analysis, text similarity, keyness, and dictionary to name a few. We will however mainly use <code>quanteda</code> and <code>quanteda.textstats</code> packages to do these.</p>
<div id="cleaning-text-data" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Cleaning text data:<a href="#cleaning-text-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="removing-the-noise" class="section level3 hasAnchor" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> Removing the noise<a href="#removing-the-noise" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The main difference between text as data-source and other data sources such as surveys is how structured the data is. For example, if you download one of the major surveys such as European Social Survey (ESS), you will get a dataset which is cleaned and structured thus ready to use. We often don’t have this luxury with text as data-source. Raw datasets produced directly from text are often very noisy. So far we have seen how load and wrangle text data into a numeric representation. There is still business of cleaning it. So we will start by taking a look at a few common methods of cleaning text data. For illustration we will use EUspeech dataset again.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textstats)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>eu_speech<span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">&quot;euspeech&quot;</span>,<span class="st">&quot;speech_data&quot;</span>,<span class="st">&quot;EU_speech.RDS&quot;</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(eu_speech)</span></code></pre></div>
<pre><code>## Rows: 12,297
## Columns: 8
## $ texts     &lt;chr&gt; &quot;today littl like chang guard outgo chairman european counci~
## $ title     &lt;chr&gt; &quot;Intervention of Guy Verhofstadt during the Conference of Pr~
## $ date      &lt;chr&gt; &quot;05-11-2014&quot;, &quot;22-10-2014&quot;, &quot;20-06-2013&quot;, &quot;15-04-2013&quot;, &quot;13-~
## $ country   &lt;chr&gt; &quot;European Parliament&quot;, &quot;European Parliament&quot;, &quot;European Parl~
## $ speaker   &lt;chr&gt; &quot;Guy Verhofstadt&quot;, &quot;Guy Verhofstadt&quot;, &quot;Guy Verhofstadt&quot;, &quot;Gu~
## $ length    &lt;int&gt; 393, 78, 280, 317, 582, 356, 861, 820, 515, 1425, 370, 214, ~
## $ language  &lt;chr&gt; &quot;en&quot;, &quot;en&quot;, &quot;en&quot;, &quot;en&quot;, &quot;en&quot;, &quot;en&quot;, &quot;en&quot;, &quot;en&quot;, &quot;en&quot;, &quot;en&quot;, ~
## $ language2 &lt;chr&gt; &quot;english&quot;, &quot;english&quot;, &quot;english&quot;, &quot;english&quot;, &quot;english&quot;, &quot;engl~</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>eu_speech<span class="ot">&lt;-</span> eu_speech <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;doc_id&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(texts<span class="sc">:</span>speaker,doc_id,<span class="sc">-</span>title)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>eu_speech_corpus<span class="ot">&lt;-</span> <span class="fu">corpus</span>(<span class="at">x =</span> eu_speech,<span class="at">docid_field =</span> <span class="st">&quot;doc_id&quot;</span>,<span class="at">text_field =</span> <span class="st">&quot;texts&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">docid</span>(eu_speech_corpus))</span></code></pre></div>
<pre><code>## [1] Verhofstadt_1 Verhofstadt_2 Verhofstadt_4 Verhofstadt_5 Verhofstadt_6
## [6] Verhofstadt_7
## 12297 Levels: Verhofstadt_1 Verhofstadt_2 Verhofstadt_4 ... Blair_787</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">docvars</span>(eu_speech_corpus))</span></code></pre></div>
<pre><code>## [1] &quot;date&quot;    &quot;country&quot; &quot;speaker&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>eu_speech_tokens<span class="ot">&lt;-</span> eu_speech_corpus <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens</span>()</span></code></pre></div>
<p>Lets quickly break down the code.First we load the dataset to our work environment. Then we create a column called doc_id. Every document in the corpus needs to have a unique id so that we can keep track of them. In this case we are lucky and the documents were given a unique id by people who created the dataset. Then we select relevant variables to keep in the dataset and remove irrelevant one (i.e title). We do this for two reasons, first <code>corpus()</code> function retain all variables besides what we specified as <code>docid_field</code> and <code>text_field</code> as document information. This can be very useful, for example, if you want to study a subset of document. However, having too many variables as document variables can easily lead to confusion and tax your computer. Finally, we create tokens out of corpus. So far we have only repeated what we saw in the last chapter.</p>
<p>Now begins the fun part, that is cleaning the data. Unfortunately, there is no fix recipie for this but there are a few common cleaning practices. First of these is removing stop words. Stop words are words that are extremely common in the text and not very informative. Articles such as “the” and “a/an”, and prepositions such as “on”, “in”, “by” are a few examples in English. There are existing lists of these words available for several languages in <code>stopwords</code> package. It is important to note that stop words are not necessarily meaningless or the same in all languages. Consider this sentence: “The property of Justice minister was vandalized by his own wife”. If we indiscriminately remove prepositions we would also get rid of “by” which indicates who did the action. We can often remove stopwords in a bag-of-words approach as we don’t care about word sequences but they can be useful for other things such as clause analysis. Another important point is that they won’t be the same group of words in every language. For example, in some agglutinative languages such Hungarian and Turkish, do not have articles but prepositions. So it is important to carefully consider your data source and your purpose before cleaning the data. lets see an example of how to do this:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(eu_speech_tokens)</span></code></pre></div>
<pre><code>## Tokens consisting of 6 documents and 3 docvars.
## Verhofstadt_1 :
##  [1] &quot;today&quot;    &quot;littl&quot;    &quot;like&quot;     &quot;chang&quot;    &quot;guard&quot;    &quot;outgo&quot;   
##  [7] &quot;chairman&quot; &quot;european&quot; &quot;council&quot;  &quot;herman&quot;   &quot;van&quot;      &quot;rompuy&quot;  
## [ ... and 196 more ]
## 
## Verhofstadt_2 :
##  [1] &quot;speech&quot;     &quot;mention&quot;    &quot;letter&quot;     &quot;bernard&quot;    &quot;foccrouill&quot;
##  [6] &quot;director&quot;   &quot;music&quot;      &quot;festiv&quot;     &quot;aix&quot;        &quot;en&quot;        
## [11] &quot;provenc&quot;    &quot;name&quot;      
## [ ... and 30 more ]
## 
## Verhofstadt_4 :
##  [1] &quot;liber&quot;      &quot;democrat&quot;   &quot;take&quot;       &quot;budgetari&quot;  &quot;power&quot;     
##  [6] &quot;european&quot;   &quot;parliament&quot; &quot;serious&quot;    &quot;confirm&quot;    &quot;report&quot;    
## [11] &quot;negoti&quot;     &quot;next&quot;      
## [ ... and 128 more ]
## 
## Verhofstadt_5 :
##  [1] &quot;four&quot;     &quot;year&quot;     &quot;sustain&quot;  &quot;financi&quot;  &quot;crisi&quot;    &quot;ad&quot;      
##  [7] &quot;hoc&quot;      &quot;polici&quot;   &quot;measur&quot;   &quot;cypriot&quot;  &quot;experi&quot;   &quot;demonstr&quot;
## [ ... and 169 more ]
## 
## Verhofstadt_6 :
##  [1] &quot;intervent&quot; &quot;march&quot;     &quot;spring&quot;    &quot;european&quot;  &quot;council&quot;   &quot;dear&quot;     
##  [7] &quot;presid&quot;    &quot;start&quot;     &quot;request&quot;   &quot;may&quot;       &quot;ask&quot;       &quot;rais&quot;     
## [ ... and 286 more ]
## 
## Verhofstadt_7 :
##  [1] &quot;respond&quot;  &quot;today&quot;    &quot;european&quot; &quot;council&quot;  &quot;presid&quot;   &quot;herman&quot;  
##  [7] &quot;van&quot;      &quot;rompuy&quot;   &quot;invit&quot;    &quot;enlarg&quot;   &quot;confer&quot;   &quot;presid&quot;  
## [ ... and 161 more ]</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>eu_speech_tokens_no_stop_words<span class="ot">&lt;-</span> eu_speech_tokens <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_select</span>(<span class="at">pattern =</span> <span class="fu">stopwords</span>(<span class="at">language =</span> <span class="st">&quot;en&quot;</span>,<span class="at">source =</span> <span class="st">&quot;snowball&quot;</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">selection =</span> <span class="st">&quot;remove&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">valuetype =</span> <span class="st">&quot;fixed&quot;</span>)</span></code></pre></div>
<p>You can also create your own stopword dictionary based on your corpus. Extremely frequent and extremely rare words are often not very informative for quantitative analysis. So we can identify them and remove them as well.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>eu_speech_dfm<span class="ot">&lt;-</span> eu_speech_tokens_no_stop_words <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>eu_speech_frequencies<span class="ot">&lt;-</span> <span class="fu">textstat_frequency</span>(<span class="at">x =</span> eu_speech_dfm)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>eu_speech_max_10<span class="ot">&lt;-</span> eu_speech_frequencies <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> frequency,<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>eu_speech_min_10<span class="ot">&lt;-</span> eu_speech_frequencies <span class="sc">%&gt;%</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(<span class="at">order_by =</span> frequency,<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>top_and_bottom<span class="ot">&lt;-</span> <span class="fu">rbind</span>(eu_speech_max_10,eu_speech_min_10)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>top_and_bottom[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> feature,<span class="at">y =</span> frequency))<span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> rank),<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Very common and rare words in the EU speech data&quot;</span>)</span></code></pre></div>
<p><img src="07-text_cleaning_files/figure-html/own_stopwords-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>eu_speech_stopwords<span class="ot">&lt;-</span> top_and_bottom <span class="sc">%&gt;%</span> <span class="fu">pull</span>(feature)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>eu_speech_tokens_no_stop_words<span class="ot">&lt;-</span> eu_speech_tokens_no_stop_words <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_select</span>(<span class="at">pattern =</span> eu_speech_stopwords, <span class="at">selection =</span> <span class="st">&quot;remove&quot;</span>,<span class="at">valuetype =</span> <span class="st">&quot;fixed&quot;</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>eu_speech_tokens_no_stop_words <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>() <span class="sc">%&gt;%</span> <span class="fu">textstat_frequency</span>(<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> feature, <span class="at">y =</span> frequency))<span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> rank),<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Very common and rare words in the EU speech data after cleaning&quot;</span>)</span></code></pre></div>
<p><img src="07-text_cleaning_files/figure-html/own_stopwords-2.png" width="672" /></p>
<p>Another thing we might want to remove is symbols and punctuation. While these are very meaningful in a sentence, they are often not very information in a bag-of-word approach. Lets see two different ways to do it:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>eu_speech_tokens_no_stop_words_punctuation<span class="ot">&lt;-</span> eu_speech_tokens_no_stop_words <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_select</span>(<span class="at">pattern =</span> <span class="st">&quot;[[:alnum:]]&quot;</span>,<span class="at">selection =</span> <span class="st">&quot;keep&quot;</span>, <span class="at">valuetype =</span> <span class="st">&quot;regex&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>eu_speech_tokens_no_stop_words_punctuation_alt<span class="ot">&lt;-</span> eu_speech_tokens_no_stop_words <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_select</span>(<span class="at">pattern =</span> <span class="st">&quot;[[:punct:]]&quot;</span>,<span class="at">selection =</span> <span class="st">&quot;remove&quot;</span>, <span class="at">valuetype =</span> <span class="st">&quot;regex&quot;</span>)</span></code></pre></div>
<p>Here, we are using something we didn’t before. Expressions <code>[:alnum:]</code> and <code>[:punct:]</code> are called regular expressions or regex. Regular expressions are used to identify a pattern in a text. We will not dive deep into how to create these from scratch, you can take a look at this <a href="https://stringr.tidyverse.org/articles/regular-expressions.html">web-page</a> for further information. Going back to the example above, we removed symbols and punctuation in two different ways. In the first example, we are keeping all alpha-numeric expressions with <code>[:alnum:]</code> regex while discarding everything else. Whereas in the second example, we are explicitly removing punctuation with <code>[:punct:]</code> while keeping symbols such as € and $. This is to show that there are many ways to accomplish a task and you need to choose the method that works for you.</p>
</div>
<div id="stemming-and-lemmatization" class="section level3 hasAnchor" number="1.1.2">
<h3><span class="header-section-number">1.1.2</span> Stemming and lemmatization:<a href="#stemming-and-lemmatization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another common way of reducing noise in the text data is stemming. Stemming is removing the suffixes of a word and keep only the root of the word. For example, if we have words <em>fishes</em>, <em>fishing</em>, <em>fished</em>, and <em>fisher</em> in the document, converting them into token would create four individual columns in the dataset. However, stemming would convert these word to <em>fish</em> thus reducing the number of dimensions in the dataset. Stemming inevitably causes some meaning loss, after all “<em>fishers went fishing for fishes and fished tons of fish</em>” has a completely different meaning than “<em>fish went fish for fish and fish tons fish</em>”, however, if the individual words do not occur frequently enough they would only confuse the statistical inference.</p>
<p>Lemmatisation serves a similar purpose as stemming. The main difference is lemmatisation is more aggressive. Consider words <em>go</em>, <em>going</em>, <em>went</em>, and <em>gone</em>. They are all time conjugates of the verb <em>to go</em>. Unlike stemming, lemmatisation would remove conjugation and convert them to <em>go</em>. The main advantage of lemmatisation is that it is able to differentiate between words based on context a bit better than stemming. For example, The word “meeting” can be either the base form of a noun or a form of a verb (“to meet”) depending on the context; e.g., <em>in our last meeting</em> or <em>We are meeting again tomorrow</em>. Unlike stemming, lemmatisation attempts to select the correct lemma depending on the context. There is unfortunately no sure-fire recipe to make one better than the other one. So you need to consider gains and loses of employing each method. Now, lets see how we can do them:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>eu_speech_stemmed<span class="ot">&lt;-</span> eu_speech_tokens <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_wordstem</span>(<span class="at">language =</span> <span class="st">&quot;english&quot;</span>)</span></code></pre></div>
<p>The code above will stem English words and return them as tokens. Quanteda package is able to do stemming in the following package if you have <code>SnowballC</code> package installed. In this particular case, the speeches are already stemmed by the authors so we do not observe any difference in the results.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>SnowballC<span class="sc">::</span><span class="fu">getStemLanguages</span>()</span></code></pre></div>
<pre><code>##  [1] &quot;arabic&quot;     &quot;basque&quot;     &quot;catalan&quot;    &quot;danish&quot;     &quot;dutch&quot;     
##  [6] &quot;english&quot;    &quot;finnish&quot;    &quot;french&quot;     &quot;german&quot;     &quot;greek&quot;     
## [11] &quot;hindi&quot;      &quot;hungarian&quot;  &quot;indonesian&quot; &quot;irish&quot;      &quot;italian&quot;   
## [16] &quot;lithuanian&quot; &quot;nepali&quot;     &quot;norwegian&quot;  &quot;porter&quot;     &quot;portuguese&quot;
## [21] &quot;romanian&quot;   &quot;russian&quot;    &quot;spanish&quot;    &quot;swedish&quot;    &quot;tamil&quot;     
## [26] &quot;turkish&quot;</code></pre>
<p>For lemmatisation, however, we need another package. So we will make a quick detour in our workflow to get lemmatisation. Note that you need to have python installed for this pacage to work</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install the package</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;spacyr&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#load the package</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spacyr)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install spacy python executables</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">spacy_install</span>()</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize spacy</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">spacy_initialize</span>()</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#process speeches</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>eu_speech_lemmatised<span class="ot">&lt;-</span> <span class="fu">spacy_parse</span>(<span class="at">x =</span> eu_speech<span class="sc">$</span>texts,<span class="at">lemma =</span> T)</span></code></pre></div>
<p>Bonus point, you can do named entity recognition, a natural language processing designed to extract entities such as place and people names with <code>spacyr</code> too.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/%s",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
